<script>
/* Failsafe power wiring — works even if app.js or Firebase fail */
(function () {
  function wirePower() {
    var power = document.getElementById('powerBtn');
    var device = document.querySelector('.device');
    var status = document.getElementById('status');
    var splash = document.getElementById('screen-splash');
    var menu   = document.getElementById('screen-menu');
    var dash   = document.getElementById('screen-dash');
    var t1 = document.getElementById('type1');
    var t2 = document.getElementById('type2');

    if (!power || !device) return;
    if (power.__wired) return;           // avoid double-binding
    power.__wired = true;

    power.addEventListener('click', function () {
      var turningOn = device.classList.contains('off');
      device.classList.toggle('off', !turningOn);
      power.classList.toggle('on', turningOn);
      if (status) status.textContent = turningOn ? 'Power on.' : 'Powered off.';

      // Basic splash → menu (no dependencies)
      if (turningOn) {
        if (splash && menu && dash) {
          splash.classList.add('active');
          menu.classList.remove('active');
          dash.classList.remove('active');
          if (t1) t1.textContent = 'Walkie-Talkie';
          if (t2) t2.textContent = 'By Praggie';
          setTimeout(function () {
            splash.classList.remove('active');
            menu.classList.add('active');
          }, 900);
        }
      }
    });
  }
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', wirePower);
  } else {
    wirePower();
  }
})();
</script>
